use super::gop::{Color, Framebuffer};

pub const CHAR_WIDTH: usize = 8;
pub const CHAR_HEIGHT: usize = 16;

/// Standard VGA 8x16 bitmap font for ASCII 0x20-0x7E.
/// Each character is 16 bytes (16 rows, MSB-first, 8 pixels wide).
#[rustfmt::skip]
static FONT_DATA: [u8; 128 * 16] = {
    let mut data = [0u8; 128 * 16];

    // Space (0x20) - all zeros, already default

    // ! (0x21)
    data[0x21*16+ 2] = 0x18; data[0x21*16+ 3] = 0x3C; data[0x21*16+ 4] = 0x3C;
    data[0x21*16+ 5] = 0x3C; data[0x21*16+ 6] = 0x18; data[0x21*16+ 7] = 0x18;
    data[0x21*16+ 8] = 0x18; data[0x21*16+ 9] = 0x00; data[0x21*16+10] = 0x18;
    data[0x21*16+11] = 0x18;

    // " (0x22)
    data[0x22*16+ 2] = 0x6C; data[0x22*16+ 3] = 0x6C; data[0x22*16+ 4] = 0x6C;

    // # (0x23)
    data[0x23*16+ 2] = 0x6C; data[0x23*16+ 3] = 0x6C; data[0x23*16+ 4] = 0xFE;
    data[0x23*16+ 5] = 0x6C; data[0x23*16+ 6] = 0xFE; data[0x23*16+ 7] = 0x6C;
    data[0x23*16+ 8] = 0x6C;

    // $ (0x24)
    data[0x24*16+ 1] = 0x18; data[0x24*16+ 2] = 0x7E; data[0x24*16+ 3] = 0xC0;
    data[0x24*16+ 4] = 0x7C; data[0x24*16+ 5] = 0x06; data[0x24*16+ 6] = 0xFC;
    data[0x24*16+ 7] = 0x18;

    // % (0x25)
    data[0x25*16+ 2] = 0xC6; data[0x25*16+ 3] = 0xCC; data[0x25*16+ 4] = 0x18;
    data[0x25*16+ 5] = 0x30; data[0x25*16+ 6] = 0x66; data[0x25*16+ 7] = 0xC6;

    // & (0x26)
    data[0x26*16+ 2] = 0x38; data[0x26*16+ 3] = 0x6C; data[0x26*16+ 4] = 0x38;
    data[0x26*16+ 5] = 0x76; data[0x26*16+ 6] = 0xDC; data[0x26*16+ 7] = 0xCC;
    data[0x26*16+ 8] = 0x76;

    // ' (0x27)
    data[0x27*16+ 2] = 0x18; data[0x27*16+ 3] = 0x18; data[0x27*16+ 4] = 0x30;

    // ( (0x28)
    data[0x28*16+ 2] = 0x0C; data[0x28*16+ 3] = 0x18; data[0x28*16+ 4] = 0x30;
    data[0x28*16+ 5] = 0x30; data[0x28*16+ 6] = 0x30; data[0x28*16+ 7] = 0x18;
    data[0x28*16+ 8] = 0x0C;

    // ) (0x29)
    data[0x29*16+ 2] = 0x30; data[0x29*16+ 3] = 0x18; data[0x29*16+ 4] = 0x0C;
    data[0x29*16+ 5] = 0x0C; data[0x29*16+ 6] = 0x0C; data[0x29*16+ 7] = 0x18;
    data[0x29*16+ 8] = 0x30;

    // * (0x2A)
    data[0x2A*16+ 3] = 0x66; data[0x2A*16+ 4] = 0x3C; data[0x2A*16+ 5] = 0xFF;
    data[0x2A*16+ 6] = 0x3C; data[0x2A*16+ 7] = 0x66;

    // + (0x2B)
    data[0x2B*16+ 4] = 0x18; data[0x2B*16+ 5] = 0x18; data[0x2B*16+ 6] = 0x7E;
    data[0x2B*16+ 7] = 0x18; data[0x2B*16+ 8] = 0x18;

    // , (0x2C)
    data[0x2C*16+ 9] = 0x18; data[0x2C*16+10] = 0x18; data[0x2C*16+11] = 0x30;

    // - (0x2D)
    data[0x2D*16+ 6] = 0x7E;

    // . (0x2E)
    data[0x2E*16+10] = 0x18; data[0x2E*16+11] = 0x18;

    // / (0x2F)
    data[0x2F*16+ 2] = 0x06; data[0x2F*16+ 3] = 0x0C; data[0x2F*16+ 4] = 0x18;
    data[0x2F*16+ 5] = 0x30; data[0x2F*16+ 6] = 0x60; data[0x2F*16+ 7] = 0xC0;

    // 0 (0x30)
    data[0x30*16+ 2] = 0x7C; data[0x30*16+ 3] = 0xC6; data[0x30*16+ 4] = 0xCE;
    data[0x30*16+ 5] = 0xDE; data[0x30*16+ 6] = 0xF6; data[0x30*16+ 7] = 0xE6;
    data[0x30*16+ 8] = 0x7C;

    // 1 (0x31)
    data[0x31*16+ 2] = 0x18; data[0x31*16+ 3] = 0x38; data[0x31*16+ 4] = 0x78;
    data[0x31*16+ 5] = 0x18; data[0x31*16+ 6] = 0x18; data[0x31*16+ 7] = 0x18;
    data[0x31*16+ 8] = 0x7E;

    // 2 (0x32)
    data[0x32*16+ 2] = 0x7C; data[0x32*16+ 3] = 0xC6; data[0x32*16+ 4] = 0x06;
    data[0x32*16+ 5] = 0x1C; data[0x32*16+ 6] = 0x30; data[0x32*16+ 7] = 0x60;
    data[0x32*16+ 8] = 0xFE;

    // 3 (0x33)
    data[0x33*16+ 2] = 0x7C; data[0x33*16+ 3] = 0xC6; data[0x33*16+ 4] = 0x06;
    data[0x33*16+ 5] = 0x3C; data[0x33*16+ 6] = 0x06; data[0x33*16+ 7] = 0xC6;
    data[0x33*16+ 8] = 0x7C;

    // 4 (0x34)
    data[0x34*16+ 2] = 0x1C; data[0x34*16+ 3] = 0x3C; data[0x34*16+ 4] = 0x6C;
    data[0x34*16+ 5] = 0xCC; data[0x34*16+ 6] = 0xFE; data[0x34*16+ 7] = 0x0C;
    data[0x34*16+ 8] = 0x0C;

    // 5 (0x35)
    data[0x35*16+ 2] = 0xFE; data[0x35*16+ 3] = 0xC0; data[0x35*16+ 4] = 0xFC;
    data[0x35*16+ 5] = 0x06; data[0x35*16+ 6] = 0x06; data[0x35*16+ 7] = 0xC6;
    data[0x35*16+ 8] = 0x7C;

    // 6 (0x36)
    data[0x36*16+ 2] = 0x3C; data[0x36*16+ 3] = 0x60; data[0x36*16+ 4] = 0xC0;
    data[0x36*16+ 5] = 0xFC; data[0x36*16+ 6] = 0xC6; data[0x36*16+ 7] = 0xC6;
    data[0x36*16+ 8] = 0x7C;

    // 7 (0x37)
    data[0x37*16+ 2] = 0xFE; data[0x37*16+ 3] = 0xC6; data[0x37*16+ 4] = 0x0C;
    data[0x37*16+ 5] = 0x18; data[0x37*16+ 6] = 0x30; data[0x37*16+ 7] = 0x30;
    data[0x37*16+ 8] = 0x30;

    // 8 (0x38)
    data[0x38*16+ 2] = 0x7C; data[0x38*16+ 3] = 0xC6; data[0x38*16+ 4] = 0xC6;
    data[0x38*16+ 5] = 0x7C; data[0x38*16+ 6] = 0xC6; data[0x38*16+ 7] = 0xC6;
    data[0x38*16+ 8] = 0x7C;

    // 9 (0x39)
    data[0x39*16+ 2] = 0x7C; data[0x39*16+ 3] = 0xC6; data[0x39*16+ 4] = 0xC6;
    data[0x39*16+ 5] = 0x7E; data[0x39*16+ 6] = 0x06; data[0x39*16+ 7] = 0x0C;
    data[0x39*16+ 8] = 0x78;

    // : (0x3A)
    data[0x3A*16+ 4] = 0x18; data[0x3A*16+ 5] = 0x18; data[0x3A*16+ 8] = 0x18;
    data[0x3A*16+ 9] = 0x18;

    // ; (0x3B)
    data[0x3B*16+ 4] = 0x18; data[0x3B*16+ 5] = 0x18; data[0x3B*16+ 8] = 0x18;
    data[0x3B*16+ 9] = 0x18; data[0x3B*16+10] = 0x30;

    // < (0x3C)
    data[0x3C*16+ 3] = 0x06; data[0x3C*16+ 4] = 0x0C; data[0x3C*16+ 5] = 0x18;
    data[0x3C*16+ 6] = 0x30; data[0x3C*16+ 7] = 0x18; data[0x3C*16+ 8] = 0x0C;
    data[0x3C*16+ 9] = 0x06;

    // = (0x3D)
    data[0x3D*16+ 5] = 0x7E; data[0x3D*16+ 7] = 0x7E;

    // > (0x3E)
    data[0x3E*16+ 3] = 0x60; data[0x3E*16+ 4] = 0x30; data[0x3E*16+ 5] = 0x18;
    data[0x3E*16+ 6] = 0x0C; data[0x3E*16+ 7] = 0x18; data[0x3E*16+ 8] = 0x30;
    data[0x3E*16+ 9] = 0x60;

    // ? (0x3F)
    data[0x3F*16+ 2] = 0x7C; data[0x3F*16+ 3] = 0xC6; data[0x3F*16+ 4] = 0x0C;
    data[0x3F*16+ 5] = 0x18; data[0x3F*16+ 6] = 0x18; data[0x3F*16+ 7] = 0x00;
    data[0x3F*16+ 8] = 0x18;

    // @ (0x40)
    data[0x40*16+ 2] = 0x7C; data[0x40*16+ 3] = 0xC6; data[0x40*16+ 4] = 0xDE;
    data[0x40*16+ 5] = 0xDE; data[0x40*16+ 6] = 0xDE; data[0x40*16+ 7] = 0xC0;
    data[0x40*16+ 8] = 0x7C;

    // A-Z (0x41-0x5A)
    // A
    data[0x41*16+ 2] = 0x10; data[0x41*16+ 3] = 0x38; data[0x41*16+ 4] = 0x6C;
    data[0x41*16+ 5] = 0xC6; data[0x41*16+ 6] = 0xFE; data[0x41*16+ 7] = 0xC6;
    data[0x41*16+ 8] = 0xC6;
    // B
    data[0x42*16+ 2] = 0xFC; data[0x42*16+ 3] = 0x66; data[0x42*16+ 4] = 0x66;
    data[0x42*16+ 5] = 0x7C; data[0x42*16+ 6] = 0x66; data[0x42*16+ 7] = 0x66;
    data[0x42*16+ 8] = 0xFC;
    // C
    data[0x43*16+ 2] = 0x3C; data[0x43*16+ 3] = 0x66; data[0x43*16+ 4] = 0xC0;
    data[0x43*16+ 5] = 0xC0; data[0x43*16+ 6] = 0xC0; data[0x43*16+ 7] = 0x66;
    data[0x43*16+ 8] = 0x3C;
    // D
    data[0x44*16+ 2] = 0xF8; data[0x44*16+ 3] = 0x6C; data[0x44*16+ 4] = 0x66;
    data[0x44*16+ 5] = 0x66; data[0x44*16+ 6] = 0x66; data[0x44*16+ 7] = 0x6C;
    data[0x44*16+ 8] = 0xF8;
    // E
    data[0x45*16+ 2] = 0xFE; data[0x45*16+ 3] = 0x62; data[0x45*16+ 4] = 0x68;
    data[0x45*16+ 5] = 0x78; data[0x45*16+ 6] = 0x68; data[0x45*16+ 7] = 0x62;
    data[0x45*16+ 8] = 0xFE;
    // F
    data[0x46*16+ 2] = 0xFE; data[0x46*16+ 3] = 0x62; data[0x46*16+ 4] = 0x68;
    data[0x46*16+ 5] = 0x78; data[0x46*16+ 6] = 0x68; data[0x46*16+ 7] = 0x60;
    data[0x46*16+ 8] = 0xF0;
    // G
    data[0x47*16+ 2] = 0x3C; data[0x47*16+ 3] = 0x66; data[0x47*16+ 4] = 0xC0;
    data[0x47*16+ 5] = 0xC0; data[0x47*16+ 6] = 0xCE; data[0x47*16+ 7] = 0x66;
    data[0x47*16+ 8] = 0x3E;
    // H
    data[0x48*16+ 2] = 0xC6; data[0x48*16+ 3] = 0xC6; data[0x48*16+ 4] = 0xC6;
    data[0x48*16+ 5] = 0xFE; data[0x48*16+ 6] = 0xC6; data[0x48*16+ 7] = 0xC6;
    data[0x48*16+ 8] = 0xC6;
    // I
    data[0x49*16+ 2] = 0x3C; data[0x49*16+ 3] = 0x18; data[0x49*16+ 4] = 0x18;
    data[0x49*16+ 5] = 0x18; data[0x49*16+ 6] = 0x18; data[0x49*16+ 7] = 0x18;
    data[0x49*16+ 8] = 0x3C;
    // J
    data[0x4A*16+ 2] = 0x1E; data[0x4A*16+ 3] = 0x0C; data[0x4A*16+ 4] = 0x0C;
    data[0x4A*16+ 5] = 0x0C; data[0x4A*16+ 6] = 0xCC; data[0x4A*16+ 7] = 0xCC;
    data[0x4A*16+ 8] = 0x78;
    // K
    data[0x4B*16+ 2] = 0xE6; data[0x4B*16+ 3] = 0x66; data[0x4B*16+ 4] = 0x6C;
    data[0x4B*16+ 5] = 0x78; data[0x4B*16+ 6] = 0x6C; data[0x4B*16+ 7] = 0x66;
    data[0x4B*16+ 8] = 0xE6;
    // L
    data[0x4C*16+ 2] = 0xF0; data[0x4C*16+ 3] = 0x60; data[0x4C*16+ 4] = 0x60;
    data[0x4C*16+ 5] = 0x60; data[0x4C*16+ 6] = 0x62; data[0x4C*16+ 7] = 0x66;
    data[0x4C*16+ 8] = 0xFE;
    // M
    data[0x4D*16+ 2] = 0xC6; data[0x4D*16+ 3] = 0xEE; data[0x4D*16+ 4] = 0xFE;
    data[0x4D*16+ 5] = 0xD6; data[0x4D*16+ 6] = 0xC6; data[0x4D*16+ 7] = 0xC6;
    data[0x4D*16+ 8] = 0xC6;
    // N
    data[0x4E*16+ 2] = 0xC6; data[0x4E*16+ 3] = 0xE6; data[0x4E*16+ 4] = 0xF6;
    data[0x4E*16+ 5] = 0xDE; data[0x4E*16+ 6] = 0xCE; data[0x4E*16+ 7] = 0xC6;
    data[0x4E*16+ 8] = 0xC6;
    // O
    data[0x4F*16+ 2] = 0x7C; data[0x4F*16+ 3] = 0xC6; data[0x4F*16+ 4] = 0xC6;
    data[0x4F*16+ 5] = 0xC6; data[0x4F*16+ 6] = 0xC6; data[0x4F*16+ 7] = 0xC6;
    data[0x4F*16+ 8] = 0x7C;
    // P
    data[0x50*16+ 2] = 0xFC; data[0x50*16+ 3] = 0x66; data[0x50*16+ 4] = 0x66;
    data[0x50*16+ 5] = 0x7C; data[0x50*16+ 6] = 0x60; data[0x50*16+ 7] = 0x60;
    data[0x50*16+ 8] = 0xF0;
    // Q
    data[0x51*16+ 2] = 0x7C; data[0x51*16+ 3] = 0xC6; data[0x51*16+ 4] = 0xC6;
    data[0x51*16+ 5] = 0xC6; data[0x51*16+ 6] = 0xD6; data[0x51*16+ 7] = 0xDE;
    data[0x51*16+ 8] = 0x7C; data[0x51*16+ 9] = 0x0E;
    // R
    data[0x52*16+ 2] = 0xFC; data[0x52*16+ 3] = 0x66; data[0x52*16+ 4] = 0x66;
    data[0x52*16+ 5] = 0x7C; data[0x52*16+ 6] = 0x6C; data[0x52*16+ 7] = 0x66;
    data[0x52*16+ 8] = 0xE6;
    // S
    data[0x53*16+ 2] = 0x7C; data[0x53*16+ 3] = 0xC6; data[0x53*16+ 4] = 0x60;
    data[0x53*16+ 5] = 0x38; data[0x53*16+ 6] = 0x0C; data[0x53*16+ 7] = 0xC6;
    data[0x53*16+ 8] = 0x7C;
    // T
    data[0x54*16+ 2] = 0x7E; data[0x54*16+ 3] = 0x5A; data[0x54*16+ 4] = 0x18;
    data[0x54*16+ 5] = 0x18; data[0x54*16+ 6] = 0x18; data[0x54*16+ 7] = 0x18;
    data[0x54*16+ 8] = 0x3C;
    // U
    data[0x55*16+ 2] = 0xC6; data[0x55*16+ 3] = 0xC6; data[0x55*16+ 4] = 0xC6;
    data[0x55*16+ 5] = 0xC6; data[0x55*16+ 6] = 0xC6; data[0x55*16+ 7] = 0xC6;
    data[0x55*16+ 8] = 0x7C;
    // V
    data[0x56*16+ 2] = 0xC6; data[0x56*16+ 3] = 0xC6; data[0x56*16+ 4] = 0xC6;
    data[0x56*16+ 5] = 0xC6; data[0x56*16+ 6] = 0x6C; data[0x56*16+ 7] = 0x38;
    data[0x56*16+ 8] = 0x10;
    // W
    data[0x57*16+ 2] = 0xC6; data[0x57*16+ 3] = 0xC6; data[0x57*16+ 4] = 0xC6;
    data[0x57*16+ 5] = 0xD6; data[0x57*16+ 6] = 0xFE; data[0x57*16+ 7] = 0xEE;
    data[0x57*16+ 8] = 0xC6;
    // X
    data[0x58*16+ 2] = 0xC6; data[0x58*16+ 3] = 0x6C; data[0x58*16+ 4] = 0x38;
    data[0x58*16+ 5] = 0x38; data[0x58*16+ 6] = 0x38; data[0x58*16+ 7] = 0x6C;
    data[0x58*16+ 8] = 0xC6;
    // Y
    data[0x59*16+ 2] = 0x66; data[0x59*16+ 3] = 0x66; data[0x59*16+ 4] = 0x66;
    data[0x59*16+ 5] = 0x3C; data[0x59*16+ 6] = 0x18; data[0x59*16+ 7] = 0x18;
    data[0x59*16+ 8] = 0x3C;
    // Z
    data[0x5A*16+ 2] = 0xFE; data[0x5A*16+ 3] = 0xC6; data[0x5A*16+ 4] = 0x0C;
    data[0x5A*16+ 5] = 0x18; data[0x5A*16+ 6] = 0x30; data[0x5A*16+ 7] = 0x66;
    data[0x5A*16+ 8] = 0xFE;

    // [ (0x5B)
    data[0x5B*16+ 2] = 0x3C; data[0x5B*16+ 3] = 0x30; data[0x5B*16+ 4] = 0x30;
    data[0x5B*16+ 5] = 0x30; data[0x5B*16+ 6] = 0x30; data[0x5B*16+ 7] = 0x30;
    data[0x5B*16+ 8] = 0x3C;
    // \ (0x5C)
    data[0x5C*16+ 2] = 0xC0; data[0x5C*16+ 3] = 0x60; data[0x5C*16+ 4] = 0x30;
    data[0x5C*16+ 5] = 0x18; data[0x5C*16+ 6] = 0x0C; data[0x5C*16+ 7] = 0x06;
    // ] (0x5D)
    data[0x5D*16+ 2] = 0x3C; data[0x5D*16+ 3] = 0x0C; data[0x5D*16+ 4] = 0x0C;
    data[0x5D*16+ 5] = 0x0C; data[0x5D*16+ 6] = 0x0C; data[0x5D*16+ 7] = 0x0C;
    data[0x5D*16+ 8] = 0x3C;
    // ^ (0x5E)
    data[0x5E*16+ 2] = 0x10; data[0x5E*16+ 3] = 0x38; data[0x5E*16+ 4] = 0x6C;
    data[0x5E*16+ 5] = 0xC6;
    // _ (0x5F)
    data[0x5F*16+12] = 0xFF;
    // ` (0x60)
    data[0x60*16+ 2] = 0x30; data[0x60*16+ 3] = 0x18;

    // a-z (0x61-0x7A)
    // a
    data[0x61*16+ 4] = 0x78; data[0x61*16+ 5] = 0x0C; data[0x61*16+ 6] = 0x7C;
    data[0x61*16+ 7] = 0xCC; data[0x61*16+ 8] = 0x76;
    // b
    data[0x62*16+ 2] = 0xE0; data[0x62*16+ 3] = 0x60; data[0x62*16+ 4] = 0x7C;
    data[0x62*16+ 5] = 0x66; data[0x62*16+ 6] = 0x66; data[0x62*16+ 7] = 0x66;
    data[0x62*16+ 8] = 0xDC;
    // c
    data[0x63*16+ 4] = 0x7C; data[0x63*16+ 5] = 0xC6; data[0x63*16+ 6] = 0xC0;
    data[0x63*16+ 7] = 0xC6; data[0x63*16+ 8] = 0x7C;
    // d
    data[0x64*16+ 2] = 0x1C; data[0x64*16+ 3] = 0x0C; data[0x64*16+ 4] = 0x7C;
    data[0x64*16+ 5] = 0xCC; data[0x64*16+ 6] = 0xCC; data[0x64*16+ 7] = 0xCC;
    data[0x64*16+ 8] = 0x76;
    // e
    data[0x65*16+ 4] = 0x7C; data[0x65*16+ 5] = 0xC6; data[0x65*16+ 6] = 0xFE;
    data[0x65*16+ 7] = 0xC0; data[0x65*16+ 8] = 0x7C;
    // f
    data[0x66*16+ 2] = 0x1C; data[0x66*16+ 3] = 0x36; data[0x66*16+ 4] = 0x30;
    data[0x66*16+ 5] = 0x7C; data[0x66*16+ 6] = 0x30; data[0x66*16+ 7] = 0x30;
    data[0x66*16+ 8] = 0x78;
    // g
    data[0x67*16+ 4] = 0x76; data[0x67*16+ 5] = 0xCC; data[0x67*16+ 6] = 0xCC;
    data[0x67*16+ 7] = 0x7C; data[0x67*16+ 8] = 0x0C; data[0x67*16+ 9] = 0xCC;
    data[0x67*16+10] = 0x78;
    // h
    data[0x68*16+ 2] = 0xE0; data[0x68*16+ 3] = 0x60; data[0x68*16+ 4] = 0x6C;
    data[0x68*16+ 5] = 0x76; data[0x68*16+ 6] = 0x66; data[0x68*16+ 7] = 0x66;
    data[0x68*16+ 8] = 0xE6;
    // i
    data[0x69*16+ 2] = 0x18; data[0x69*16+ 3] = 0x00; data[0x69*16+ 4] = 0x38;
    data[0x69*16+ 5] = 0x18; data[0x69*16+ 6] = 0x18; data[0x69*16+ 7] = 0x18;
    data[0x69*16+ 8] = 0x3C;
    // j
    data[0x6A*16+ 2] = 0x06; data[0x6A*16+ 3] = 0x00; data[0x6A*16+ 4] = 0x0E;
    data[0x6A*16+ 5] = 0x06; data[0x6A*16+ 6] = 0x06; data[0x6A*16+ 7] = 0x66;
    data[0x6A*16+ 8] = 0x66; data[0x6A*16+ 9] = 0x3C;
    // k
    data[0x6B*16+ 2] = 0xE0; data[0x6B*16+ 3] = 0x60; data[0x6B*16+ 4] = 0x66;
    data[0x6B*16+ 5] = 0x6C; data[0x6B*16+ 6] = 0x78; data[0x6B*16+ 7] = 0x6C;
    data[0x6B*16+ 8] = 0xE6;
    // l
    data[0x6C*16+ 2] = 0x38; data[0x6C*16+ 3] = 0x18; data[0x6C*16+ 4] = 0x18;
    data[0x6C*16+ 5] = 0x18; data[0x6C*16+ 6] = 0x18; data[0x6C*16+ 7] = 0x18;
    data[0x6C*16+ 8] = 0x3C;
    // m
    data[0x6D*16+ 4] = 0xEC; data[0x6D*16+ 5] = 0xFE; data[0x6D*16+ 6] = 0xD6;
    data[0x6D*16+ 7] = 0xD6; data[0x6D*16+ 8] = 0xC6;
    // n
    data[0x6E*16+ 4] = 0xDC; data[0x6E*16+ 5] = 0x66; data[0x6E*16+ 6] = 0x66;
    data[0x6E*16+ 7] = 0x66; data[0x6E*16+ 8] = 0x66;
    // o
    data[0x6F*16+ 4] = 0x7C; data[0x6F*16+ 5] = 0xC6; data[0x6F*16+ 6] = 0xC6;
    data[0x6F*16+ 7] = 0xC6; data[0x6F*16+ 8] = 0x7C;
    // p
    data[0x70*16+ 4] = 0xDC; data[0x70*16+ 5] = 0x66; data[0x70*16+ 6] = 0x66;
    data[0x70*16+ 7] = 0x7C; data[0x70*16+ 8] = 0x60; data[0x70*16+ 9] = 0xF0;
    // q
    data[0x71*16+ 4] = 0x76; data[0x71*16+ 5] = 0xCC; data[0x71*16+ 6] = 0xCC;
    data[0x71*16+ 7] = 0x7C; data[0x71*16+ 8] = 0x0C; data[0x71*16+ 9] = 0x1E;
    // r
    data[0x72*16+ 4] = 0xDC; data[0x72*16+ 5] = 0x76; data[0x72*16+ 6] = 0x60;
    data[0x72*16+ 7] = 0x60; data[0x72*16+ 8] = 0xF0;
    // s
    data[0x73*16+ 4] = 0x7C; data[0x73*16+ 5] = 0xC0; data[0x73*16+ 6] = 0x7C;
    data[0x73*16+ 7] = 0x06; data[0x73*16+ 8] = 0xFC;
    // t
    data[0x74*16+ 2] = 0x10; data[0x74*16+ 3] = 0x30; data[0x74*16+ 4] = 0x7C;
    data[0x74*16+ 5] = 0x30; data[0x74*16+ 6] = 0x30; data[0x74*16+ 7] = 0x36;
    data[0x74*16+ 8] = 0x1C;
    // u
    data[0x75*16+ 4] = 0xCC; data[0x75*16+ 5] = 0xCC; data[0x75*16+ 6] = 0xCC;
    data[0x75*16+ 7] = 0xCC; data[0x75*16+ 8] = 0x76;
    // v
    data[0x76*16+ 4] = 0xC6; data[0x76*16+ 5] = 0xC6; data[0x76*16+ 6] = 0x6C;
    data[0x76*16+ 7] = 0x38; data[0x76*16+ 8] = 0x10;
    // w
    data[0x77*16+ 4] = 0xC6; data[0x77*16+ 5] = 0xD6; data[0x77*16+ 6] = 0xD6;
    data[0x77*16+ 7] = 0xFE; data[0x77*16+ 8] = 0x6C;
    // x
    data[0x78*16+ 4] = 0xC6; data[0x78*16+ 5] = 0x6C; data[0x78*16+ 6] = 0x38;
    data[0x78*16+ 7] = 0x6C; data[0x78*16+ 8] = 0xC6;
    // y
    data[0x79*16+ 4] = 0xC6; data[0x79*16+ 5] = 0xC6; data[0x79*16+ 6] = 0xC6;
    data[0x79*16+ 7] = 0x7E; data[0x79*16+ 8] = 0x06; data[0x79*16+ 9] = 0xFC;
    // z
    data[0x7A*16+ 4] = 0xFE; data[0x7A*16+ 5] = 0x0C; data[0x7A*16+ 6] = 0x18;
    data[0x7A*16+ 7] = 0x30; data[0x7A*16+ 8] = 0xFE;

    // { (0x7B)
    data[0x7B*16+ 2] = 0x0E; data[0x7B*16+ 3] = 0x18; data[0x7B*16+ 4] = 0x18;
    data[0x7B*16+ 5] = 0x70; data[0x7B*16+ 6] = 0x18; data[0x7B*16+ 7] = 0x18;
    data[0x7B*16+ 8] = 0x0E;
    // | (0x7C)
    data[0x7C*16+ 2] = 0x18; data[0x7C*16+ 3] = 0x18; data[0x7C*16+ 4] = 0x18;
    data[0x7C*16+ 5] = 0x18; data[0x7C*16+ 6] = 0x18; data[0x7C*16+ 7] = 0x18;
    data[0x7C*16+ 8] = 0x18;
    // } (0x7D)
    data[0x7D*16+ 2] = 0x70; data[0x7D*16+ 3] = 0x18; data[0x7D*16+ 4] = 0x18;
    data[0x7D*16+ 5] = 0x0E; data[0x7D*16+ 6] = 0x18; data[0x7D*16+ 7] = 0x18;
    data[0x7D*16+ 8] = 0x70;
    // ~ (0x7E)
    data[0x7E*16+ 4] = 0x76; data[0x7E*16+ 5] = 0xDC;

    data
};

pub fn get_char_bitmap(ch: u8) -> &'static [u8] {
    let idx = if ch < 128 { ch as usize } else { b'?' as usize };
    let offset = idx * CHAR_HEIGHT;
    &FONT_DATA[offset..offset + CHAR_HEIGHT]
}

pub fn draw_char(fb: &mut Framebuffer, ch: u8, px: usize, py: usize, fg: Color, bg: Color) {
    let bitmap = get_char_bitmap(ch);
    for row in 0..CHAR_HEIGHT {
        let bits = bitmap[row];
        for col in 0..CHAR_WIDTH {
            let is_set = (bits >> (7 - col)) & 1 == 1;
            let color = if is_set { fg } else { bg };
            fb.set_pixel(px + col, py + row, color);
        }
    }
}

pub fn draw_string(fb: &mut Framebuffer, s: &str, px: usize, py: usize, fg: Color, bg: Color) {
    let mut x = px;
    for byte in s.bytes() {
        let ch = if byte >= 0x20 && byte <= 0x7E {
            byte
        } else {
            b'?'
        };
        draw_char(fb, ch, x, py, fg, bg);
        x += CHAR_WIDTH;
    }
}
